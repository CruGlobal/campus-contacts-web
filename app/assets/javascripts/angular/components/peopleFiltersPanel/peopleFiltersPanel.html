<div class="pivot_theme">
    <button class="reset" ng-click="$ctrl.resetFilters()" ng-if="$ctrl.filtersApplied">
        {{ 'signatures.clear' | t }}
    </button>

    <div class="filter-row filter-search">
        <input ng-model="$ctrl.filters.searchString"
               ng-model-options="{ debounce: 200 }"
               placeholder="{{'contacts.index.filter' | t}}">
    </div>

    <accordion collapsed="true" accordion-disabled="!$ctrl.labelOptions.length > 0"
               class="filter-row filter-labels">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.labels.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <label ng-repeat="labelOption in $ctrl.labelOptions" class="filter-option">
                <input type="checkbox" ng-model="$ctrl.filters.labels[labelOption.label_id]">
                <span
                    class="filter-option-name">{{ labelOption.i18n ? (labelOption.i18n | t) : labelOption.name }}</span>
                <span class="filter-option-count">{{ labelOption.count }}</span>
            </label>
        </accordion-content>
    </accordion>

    <accordion collapsed="true" accordion-disabled="!$ctrl.assignmentOptions.length > 0"
               class="filter-row assigned-to">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.assignments.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <label ng-repeat="assignmentOption in $ctrl.assignmentOptions" class="filter-option">
                <input type="checkbox" ng-model="$ctrl.filters.assigned_tos[assignmentOption.person_id]">
                <span class="filter-option-name" ng-if="assignmentOption.person_id != 'unassigned'">
                    {{ assignmentOption.name }}
                </span>
                <span class="filter-option-name" ng-if="assignmentOption.person_id == 'unassigned'">
                    {{ 'contacts.index.unassigned' | t }}
                </span>
                <span class="filter-option-count">{{ assignmentOption.count }}</span>
            </label>
        </accordion-content>
    </accordion>

    <accordion ng-if="$ctrl.surveyId" collapsed="true"
               accordion-disabled="!$ctrl.statusOptions.length > 0"
               class="filter-row filter-groups">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.status.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <label ng-repeat="statusOption in $ctrl.statusOptions" class="filter-option">
                <input type="checkbox" ng-model="$ctrl.filters.statuses[statusOption.followup_status]">
                <span class="filter-option-name">{{ 'followup_status.' + statusOption.followup_status | t }}</span>
                <span class="filter-option-count">{{ statusOption.count }}</span>
            </label>
        </accordion-content>
    </accordion>

    <accordion ng-if="$ctrl.surveyId" collapsed="true"
               accordion-disabled="!$ctrl.genderOptions.length > 0"
               class="filter-row filter-groups">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.gender.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <label ng-repeat="genderOption in $ctrl.genderOptions" class="filter-option">
                <input type="checkbox" ng-model="$ctrl.filters.genders[genderOption.gender]">
                <span class="filter-option-name">{{ 'general.' + (genderOption.gender | lowercase) | t }}</span>
                <span class="filter-option-count">{{ genderOption.count }}</span>
            </label>
        </accordion-content>
    </accordion>

    <accordion collapsed="true" accordion-disabled="!$ctrl.groupOptions.length > 0"
               class="filter-row filter-groups">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.groups.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <label ng-repeat="groupOption in $ctrl.groupOptions" class="filter-option">
                <input type="checkbox" ng-model="$ctrl.filters.groups[groupOption.group_id]">
                <span class="filter-option-name">{{ groupOption.name }}</span>
                <span class="filter-option-count">{{ groupOption.count }}</span>
            </label>
        </accordion-content>
    </accordion>

    <accordion collapsed="true"
               accordion-disabled="!$ctrl.questionOptions.length > 0"
               ng-if="$ctrl.surveyId"
               class="filter-row filter-groups">
        <accordion-header>
            <accordion-toggle class="flex-auto">{{'search.questions.title' | t}}</accordion-toggle>
        </accordion-header>
        <accordion-content>
            <accordion collapsed="true" class="filter-sub-row filter-groups" ng-repeat="question in $ctrl.questionOptions">
                <accordion-header>
                    <accordion-toggle class="flex-auto">{{($ctrl.questions | filter: {id: question.question_id})[0].label}}</accordion-toggle>
                </accordion-header>
                <accordion-content>
                    <label ng-repeat="answerOption in question.answers" class="filter-option">
                        <input type="checkbox"
                               ng-model="$ctrl.filters.questions[question.question_id][answerOption.value]">
                        <span class="filter-option-name">{{ answerOption.value }}</span>
                        <span class="filter-option-count">{{ answerOption.count }}</span>
                    </label>
                </accordion-content>
        </accordion-content>
    </accordion>

    <div class="filter-row filter-archived">
        <label>
            <input type="checkbox" ng-model="$ctrl.filters.includeArchived">
            <span class="filter-option-name">{{ 'search.sidebar.include_archived' | t }}</span>
        </label>
    </div>
</div>
