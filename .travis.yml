sudo: false
cache: bundler
language: ruby
rvm: 2.2.2
branches:
  only:
    - master
    - staging
    - fix_travis
services:
  - redis-server

notifications:
  recipients:
    - josh.starcher@cojourners.com
    - kennethjohnbalgos@gmail.com
    - marvindpunongbayan@gmail.com

before_script:
  - cp config/s3.travis.yml config/s3.yml
  - cp config/database.travis.yml config/database.yml
  - cp config/config.travis.yml config/config.yml
  - bundle exec rake db:create RAILS_ENV=test
  - bundle exec rake db:structure:load RAILS_ENV=test

script: "bundle exec rake test"

env:
  - REDIS_PORT_6379_TCP_ADDR=localhost REDIS_PORT_6379_TCP_PORT=6379 APP_DOMAIN=localhost.com
